services:
  m4brew:
    build: .
    container_name: m4brew

    ports:
      - "8585:8080"

    volumes:
      - /mnt/remotes/192.168.4.4_media/Audiobooks:/mnt/remotes/192.168.4.4_media/Audiobooks:rw

      # Persistent config (settings.json + history.jsonl)
      - /mnt/cache/appdata/m4brew/config:/config

      # Docker socket so the script can run docker on the host
      - /var/run/docker.sock:/var/run/docker.sock:ro

    environment:
      MODE: "convert"
      DRY_RUN: "true"

    restart: unless-stopped
