{% extends "base.html" %}
{% block title %}M4Brew • Run{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='history.css') }}">
{% endblock %}

{% block content %}
<div class="card card--history-detail">
  <a class="run-detail-close" href="/history" aria-label="Close">×</a>

  <h2 class="run-detail-title">Run detail</h2>

  <div class="run-detail-meta muted">
    <span class="mono">{{ detail.runtime_h }}</span>
    •
    <span class="mono">{{ detail.ts_human }}</span>
  </div>

  <div class="run-detail-grid">
    <div class="card run-detail-chip">
      <div class="muted">Task</div>
      <div class="mono run-detail-value">
        {{ 'Convert' if detail.mode == 'convert' else ('Rename' if detail.mode == 'correct' else ('Delete' if detail.mode == 'cleanup' else detail.mode)) }}
      </div>
    </div>

    <div class="card run-detail-chip">
      <div class="muted">Run type</div>
      <div class="mono run-detail-value">
        {{ 'Test' if detail.dry_run else 'Live run' }}
      </div>
    </div>
  </div>

  <div class="muted run-detail-label">Output</div>
  <pre class="run-detail-pre">{{ detail.output }}</pre>
</div>
{% endblock %}

{% block extra_js %}
<script>
(function(){
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") window.location.href = "/history";
  });
})();
</script>
{% endblock %}
